---
- hosts: test-node
  tasks:
    - shell: "pwd && id && cat /etc/passwd"
    - debug: msg="{{ lookup('env','HOME') }}"
    - name: Extract Pre-built OpenJDK 8
      unarchive:
        src: https://github.com/AdoptOpenJDK/openjdk8-releases/releases/download/jdk8u144-b01/OpenJDK8_x64_Linux_jdk8u144-b01.tar.gz
        dest: "/var/lib/zuul-worker/"
        remote_src: yes
    - name: Extract ElasticSearch 2.4.0 archive
      unarchive:
        src: https://download.elastic.co/elasticsearch/release/org/elasticsearch/distribution/tar/elasticsearch/2.4.0/elasticsearch-2.4.0.tar.gz
        dest: "/var/lib/zuul-worker/"
        remote_src: yes
    - name: Start ElasticSearch
      command: "/var/lib/zuul-worker/elasticsearch-2.4.0/bin/elasticsearch -d"
      environment:
        JAVA_HOME: "/var/lib/zuul-worker/jdk8u144-b01/"
    - name: Stats
      command: ps axf
